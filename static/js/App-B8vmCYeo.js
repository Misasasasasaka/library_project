import{l as B,r as p,c as _,m as C,p as N,f as I,q as V,g as z,h as b,a,d as x,s as A,x as L,b as e,u as y,B as j,y as r,t as l,e as i,n as M,z as R,A as S,C as T,o}from"./index-BneSkAzL.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=B("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),D={key:0,class:"text-center py-16 text-text-muted"},E={key:1,class:"text-center py-16 text-text-muted"},H={key:2,class:"bg-white rounded-2xl border border-border p-8"},O={class:"flex gap-10"},U={class:"w-56 flex-shrink-0"},$={class:"aspect-[3/4] bg-sidebar rounded-2xl overflow-hidden shadow-sm"},F=["src","alt"],G={key:1,class:"w-full h-full flex items-center justify-center text-text-light"},J={class:"flex-1"},K={class:"text-3xl font-semibold text-text-primary"},P={class:"mt-6 space-y-3 text-text-secondary"},Q={key:0},W={key:1},X={class:"font-mono"},Y={key:2},Z={key:3},tt={class:"text-text-muted"},et={class:"mt-8"},st={key:1,disabled:"",class:"btn-primary px-8 py-3 text-base opacity-50 cursor-not-allowed"},at=["disabled"],ot={key:0,class:"mt-10 pt-8 border-t border-border"},lt={class:"text-text-secondary leading-relaxed"},it={__name:"App",setup(nt){const v=N(),h=R(),t=p(null),u=p(!0),d=p(!1),f=_(()=>C.value),m=_(()=>v.params.id);I(async()=>{await c()}),V(()=>v.params.id,()=>{c()});async function c(){u.value=!0;try{const n=await z(`/api/books/${m.value}`);t.value=n.book}catch(n){b(n.message||"加载图书失败")}finally{u.value=!1}}function k(){h.push("/login/")}async function w(){d.value=!0;try{await S("/api/borrows",{book_id:parseInt(m.value)}),T("借阅成功！"),await c()}catch(n){b(n.message||"借阅失败")}finally{d.value=!1}}return(n,s)=>{const g=L("router-link");return o(),a("div",null,[x(g,{to:"/books/",class:"inline-flex items-center text-text-muted hover:text-claude-600 mb-6 transition-colors"},{default:A(()=>[x(y(q),{class:"w-5 h-5 mr-2","stroke-width":2}),s[0]||(s[0]=i(" 返回图书列表 ",-1))]),_:1}),u.value?(o(),a("div",D," 加载中... ")):t.value?(o(),a("div",H,[e("div",O,[e("div",U,[e("div",$,[t.value.cover_url?(o(),a("img",{key:0,src:t.value.cover_url,alt:t.value.title,class:"w-full h-full object-cover"},null,8,F)):(o(),a("div",G,[x(y(j),{class:"w-20 h-20","stroke-width":1})]))])]),e("div",J,[e("h1",K,l(t.value.title),1),e("div",P,[e("p",null,[s[1]||(s[1]=e("span",{class:"text-text-muted"},"作者：",-1)),i(l(t.value.author),1)]),t.value.publisher?(o(),a("p",Q,[s[2]||(s[2]=e("span",{class:"text-text-muted"},"出版社：",-1)),i(l(t.value.publisher),1)])):r("",!0),t.value.isbn?(o(),a("p",W,[s[3]||(s[3]=e("span",{class:"text-text-muted"},"ISBN：",-1)),e("span",X,l(t.value.isbn),1)])):r("",!0),t.value.category_name?(o(),a("p",Y,[s[4]||(s[4]=e("span",{class:"text-text-muted"},"分类：",-1)),i(l(t.value.category_name),1)])):r("",!0),t.value.location?(o(),a("p",Z,[s[5]||(s[5]=e("span",{class:"text-text-muted"},"位置：",-1)),i(l(t.value.location),1)])):r("",!0),e("p",null,[s[6]||(s[6]=e("span",{class:"text-text-muted"},"库存：",-1)),e("span",{class:M(t.value.available_copies>0?"text-emerald-600 font-medium":"text-red-500")}," 可借 "+l(t.value.available_copies),3),e("span",tt," / 共 "+l(t.value.total_copies)+" 本",1)])]),e("div",et,[f.value?t.value.available_copies===0?(o(),a("button",st," 暂无库存 ")):(o(),a("button",{key:2,onClick:w,disabled:d.value,class:"btn-primary px-8 py-3 text-base"},l(d.value?"借阅中...":"立即借阅"),9,at)):(o(),a("button",{key:0,onClick:k,class:"btn-primary px-8 py-3 text-base"}," 登录后借阅 "))]),t.value.description?(o(),a("div",ot,[s[7]||(s[7]=e("h3",{class:"text-lg font-medium text-text-primary mb-3"},"简介",-1)),e("p",lt,l(t.value.description),1)])):r("",!0)])])])):(o(),a("div",E," 图书不存在 "))])}}};export{it as default};
