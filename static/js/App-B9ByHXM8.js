import{E as g,g as d,h as _,i as k,d as x,b as t,e as i,w as b,r as V,G as C,y as N,k as u,v as c,t as f,f as v,z as S,o as h,u as U,H as q,I as B}from"./index-BL0x7uEM.js";const D={class:"min-h-screen bg-content flex items-center justify-center p-4"},M={class:"w-full max-w-md"},T={class:"w-16 h-16 bg-claude-500 rounded-2xl flex items-center justify-center mx-auto shadow-lg group-hover:bg-claude-600 transition-colors"},j={class:"bg-white rounded-2xl shadow-sm border border-border p-8"},E={class:"space-y-5"},R={class:"flex items-end gap-3"},z={class:"flex-1"},A=["src"],F={key:0,class:"mt-4 p-3 bg-red-50 text-red-600 text-sm rounded-xl"},G=["disabled"],H={class:"mt-6 text-center text-sm text-text-muted"},$={__name:"App",setup(I){const w=S(),s=g({username:"",password:"",captcha:""}),o=d(!1),l=d(""),p=d("");_(async()=>{try{await k("/api/auth/csrf")}catch{console.error("获取 CSRF Token 失败")}r()});function r(){p.value=`/api/auth/captcha?t=${Date.now()}`}async function y(){l.value="",o.value=!0;try{await B(s.username,s.password,s.captcha),w.push("/books/")}catch(n){l.value=n.message||"登录失败，请检查用户名和密码",s.captcha="",r()}finally{o.value=!1}}return(n,e)=>{const m=V("router-link");return h(),x("div",D,[t("div",M,[i(m,{to:"/books/",class:"block text-center mb-8 group"},{default:b(()=>[t("div",T,[i(U(q),{class:"w-8 h-8 text-white","stroke-width":2})]),e[3]||(e[3]=t("h1",{class:"mt-6 text-2xl font-semibold text-text-primary group-hover:text-claude-600 transition-colors"},"图书馆",-1)),e[4]||(e[4]=t("p",{class:"mt-2 text-text-muted"},"欢迎回来，请登录您的账户",-1))]),_:1}),t("div",j,[t("form",{onSubmit:C(y,["prevent"])},[t("div",E,[t("div",null,[e[5]||(e[5]=t("label",{class:"label"},"用户名",-1)),u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.username=a),type:"text",required:"",class:"input",placeholder:"请输入用户名"},null,512),[[c,s.username]])]),t("div",null,[e[6]||(e[6]=t("label",{class:"label"},"密码",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.password=a),type:"password",required:"",class:"input",placeholder:"请输入密码"},null,512),[[c,s.password]])]),t("div",R,[t("div",z,[e[7]||(e[7]=t("label",{class:"label"},"验证码",-1)),u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.captcha=a),type:"text",required:"",class:"input",placeholder:"请输入图片验证码"},null,512),[[c,s.captcha]])]),t("img",{src:p.value,class:"h-11 w-32 rounded-xl border border-border cursor-pointer select-none",alt:"验证码",title:"点击刷新验证码",onClick:r},null,8,A)])]),l.value?(h(),x("div",F,f(l.value),1)):N("",!0),t("button",{type:"submit",disabled:o.value,class:"mt-6 w-full btn-primary py-3 text-base font-medium"},f(o.value?"登录中...":"登录"),9,G)],32),t("p",H,[e[9]||(e[9]=v(" 还没有账户？ ",-1)),i(m,{to:"/register/",class:"text-claude-600 hover:text-claude-700 font-medium"},{default:b(()=>[...e[8]||(e[8]=[v("立即注册",-1)])]),_:1})])])])])}}};export{$ as default};
