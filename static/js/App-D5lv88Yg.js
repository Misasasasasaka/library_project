import{c as v,a as o,o as a,b as e,d as m,u as b,B as C,t as g,n as k,e as $,r as c,f as j,g as L,h as N,w as V,v as E,i as K,F as y,j as w,k as M}from"./index-BneSkAzL.js";import{S as T,L as A,_ as D}from"./Pagination-BWsnICMh.js";const F=["href"],I={class:"aspect-[3/4] bg-sidebar relative"},O=["src","alt"],U={key:1,class:"w-full h-full flex items-center justify-center text-text-light"},q={class:"p-4"},z=["title"],G={class:"text-sm text-text-muted truncate mt-1"},R={class:"mt-3"},Z={__name:"BookCard",props:{book:{type:Object,required:!0}},setup(l){const r=l,i=v(()=>r.book.status==="on_shelf"&&r.book.available_copies>0),u=v(()=>r.book.status==="off_shelf"?"已下架":r.book.available_copies===0?"已借完":"可借阅"),f=v(()=>i.value?"bg-emerald-50 text-emerald-600":"bg-border-light text-text-muted"),h=v(()=>i.value?"bg-emerald-500":"bg-text-muted");return(d,p)=>(a(),o("a",{href:`/books/${l.book.id}/`,class:"block bg-white rounded-2xl shadow-sm hover:shadow-md transition-all duration-200 overflow-hidden border border-border hover:-translate-y-0.5"},[e("div",I,[l.book.cover_url?(a(),o("img",{key:0,src:l.book.cover_url,alt:l.book.title,class:"w-full h-full object-cover"},null,8,O)):(a(),o("div",U,[m(b(C),{class:"w-16 h-16","stroke-width":1})]))]),e("div",q,[e("h3",{class:"font-medium text-text-primary truncate",title:l.book.title},g(l.book.title),9,z),e("p",G,g(l.book.author),1),e("div",R,[e("span",{class:k(["inline-flex items-center px-2.5 py-1 text-xs font-medium rounded-lg",f.value])},[e("span",{class:k(["w-1.5 h-1.5 rounded-full mr-1.5",h.value])},null,2),$(" "+g(u.value),1)],2)])])],8,F))}},H={class:"mb-8"},J={class:"flex items-center gap-4"},Q={class:"flex-1 relative"},W={class:"mb-8 flex flex-wrap gap-2"},X=["onClick"],Y={key:0,class:"text-center py-16 text-text-muted"},ee={key:1,class:"text-center py-16 text-text-muted"},te={key:2,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6"},se={class:"mt-10"},ae=20,ne={__name:"App",setup(l){const r=c(""),i=c(null),u=c([]),f=c([{id:null,name:"全部"}]),h=c(!0),d=c(1),p=c(0),B=v(()=>Math.ceil(p.value/ae));j(async()=>{await x()});async function x(){h.value=!0;try{const s=new URLSearchParams;r.value&&s.set("kw",r.value),i.value&&s.set("category",i.value),s.set("page",d.value);const n="/api/books"+(s.toString()?"?"+s.toString():""),t=await L(n);u.value=t.results||t.books||[],p.value=t.count||u.value.length}catch(s){N(s.message||"加载图书失败")}finally{h.value=!1}}function _(){d.value=1,x()}function S(s){i.value=s,d.value=1,x()}function P(s){d.value=s,x()}return(s,n)=>(a(),o("div",null,[e("div",H,[e("div",J,[e("div",Q,[V(e("input",{"onUpdate:modelValue":n[0]||(n[0]=t=>r.value=t),type:"text",placeholder:"搜索书名、作者、ISBN...",class:"w-full pl-12 pr-4 py-3 input",onKeyup:K(_,["enter"])},null,544),[[E,r.value]]),m(b(T),{class:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-text-muted","stroke-width":2})]),e("button",{onClick:_,class:"btn-primary px-6 py-3"}," 搜索 ")])]),e("div",W,[(a(!0),o(y,null,w(f.value,t=>(a(),o("button",{key:t.id,onClick:oe=>S(t.id),class:k(["px-4 py-2 rounded-xl text-sm font-medium transition-all duration-200",i.value===t.id?"bg-claude-500 text-white shadow-sm":"bg-white text-text-secondary border border-border hover:border-claude-400 hover:text-claude-600"])},g(t.name),11,X))),128))]),h.value?(a(),o("div",Y,[m(b(A),{class:"animate-spin h-10 w-10 mx-auto mb-4 text-claude-500","stroke-width":2}),n[1]||(n[1]=$(" 加载中... ",-1))])):u.value.length===0?(a(),o("div",ee,[m(b(C),{class:"w-20 h-20 mx-auto mb-4 text-text-light","stroke-width":1}),n[2]||(n[2]=e("p",{class:"text-lg"},"暂无图书",-1))])):(a(),o("div",te,[(a(!0),o(y,null,w(u.value,t=>(a(),M(Z,{key:t.id,book:t},null,8,["book"]))),128))])),e("div",se,[m(D,{"current-page":d.value,"total-pages":B.value,onChange:P},null,8,["current-page","total-pages"])])]))}};export{ne as default};
